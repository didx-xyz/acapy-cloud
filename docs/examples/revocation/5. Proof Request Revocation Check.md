# Verifying revoked credentials

## Using time stamp before revoked
Proof before

```
verifier sends
curl -X 'POST' \
  'http://localhost:8300/v1/verifier/send-request' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "protocol_version": "v2",
  "comment": "Demo",
  "type": "indy",
  "indy_proof_request": {
       "non_revoked": {"from":0 , "to": 1714727880},
       "requested_attributes": {
           "hspeed": { "name": "speed"}
        },
       "requested_predicates": {}
  },
  "save_exchange_record": true,
  "connection_id": "caf1a199-e45d-4daf-ab21-17f181b1b85e"
}'

holder calls
curl -X 'GET' \
  'http://localhost:8300/v1/verifier/proofs' \
  -H 'accept: application/json'
  [
  {
    "connection_id": "dac01860-0c84-4142-91e8-82b4ac30358d",
    "created_at": "2024-05-03T09:27:37.802280Z",
    "error_msg": null,
    "parent_thread_id": "712de5a3-15f1-4b75-bde5-65a264efe4f0",
    "presentation": null,
    "presentation_request": {
      "name": "Proof",
      "non_revoked": {
        "from": 0,
        "to": 1714727880
      },
      "nonce": "608758083548572638921682",
      "requested_attributes": {
        "hspeed": {
          "name": "speed",
          "names": null,
          "non_revoked": null,
          "restrictions": null
        }
      },
      "requested_predicates": {},
      "version": "1.0"
    },
    "proof_id": "v2-e4fc87fa-1de1-4187-bfb3-52b483e9f865",
    "protocol_version": "v2",
    "role": "prover",
    "state": "request-received",
    "thread_id": "712de5a3-15f1-4b75-bde5-65a264efe4f0",
    "updated_at": "2024-05-03T09:27:37.802280Z",
    "verified": null
  }
]

holder calls

curl -X 'GET' \
  'http://localhost:8300/v1/verifier/proofs/v2-e4fc87fa-1de1-4187-bfb3-52b483e9f865/credentials' \
  -H 'accept: application/json'

[
  {
    "cred_info": {
      "attrs": {
        "speed": "100"
      },
      "cred_def_id": "2HpYVPLeLjSBSPuFeV2jDY:3:CL:8:Epic",
      "cred_rev_id": "2",
      "referent": "5fbdf982-587b-41e2-9f92-1864e041deb4",
      "rev_reg_id": "2HpYVPLeLjSBSPuFeV2jDY:4:2HpYVPLeLjSBSPuFeV2jDY:3:CL:8:Epic:CL_ACCUM:70390905-6631-4b6e-8420-d8d1546660aa",
      "schema_id": "xTUR8cJYXPSMKb1CuFSqZ:2:Epic_speed:1.0"
    },
    "interval": {
      "from": 0,
      "to": 1714727880
    },
    "presentation_referents": [
      "hspeed"
    ]
  }
]


holder responds

curl -X 'POST' \
  'http://localhost:8300/v1/verifier/accept-request' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "proof_id": "v2-e4fc87fa-1de1-4187-bfb3-52b483e9f865",
  "type": "indy",
  "indy_presentation_spec": {
    "requested_attributes": {
      "hspeed": {
        "cred_id": "5fbdf982-587b-41e2-9f92-1864e041deb4",
        "revealed": true
      }
    },
    "requested_predicates": {},
    "self_attested_attributes": {}
  },
  "dif_presentation_spec": {}
}'

verifier checks

  {
    "wallet_id": "c0330bf8-e755-4deb-b577-03abace9c757",
    "topic": "proofs",
    "origin": "tenant faber",
    "group_id": "GroupA",
    "payload": {
      "connection_id": "caf1a199-e45d-4daf-ab21-17f181b1b85e",
      "created_at": "2024-05-03T09:27:37.745659Z",
      "error_msg": null,
      "parent_thread_id": null,
      "presentation": null,
      "presentation_request": null,
      "proof_id": "v2-877e990f-b945-4c60-9cf8-632fda651ec1",
      "protocol_version": "v2",
      "role": "verifier",
      "state": "done",
      "thread_id": "712de5a3-15f1-4b75-bde5-65a264efe4f0",
      "updated_at": "2024-05-03T09:30:05.078032Z",
      "verified": true
    }
  }
```
## Using time stamp after revoked time
```
verifier sends
curl -X 'POST' \
  'http://localhost:8300/v1/verifier/send-request' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "protocol_version": "v2",
  "comment": "Demo",
  "type": "indy",
  "indy_proof_request": {
       "non_revoked": {"from":0 , "to": 1714728600},
       "requested_attributes": {
           "hspeed": { "name": "speed"}
        },
       "requested_predicates": {}
  },
  "save_exchange_record": true,
  "connection_id": "caf1a199-e45d-4daf-ab21-17f181b1b85e"
}'


holder gets

curl -X 'GET' \
  'http://localhost:8300/v1/verifier/proofs' \
  -H 'accept: application/json'
  [
  {
    "connection_id": "dac01860-0c84-4142-91e8-82b4ac30358d",
    "created_at": "2024-05-03T09:39:24.853669Z",
    "error_msg": null,
    "parent_thread_id": "6f31a4b9-f064-444e-95bd-a1310d9b0bf1",
    "presentation": null,
    "presentation_request": {
      "name": "Proof",
      "non_revoked": {
        "from": 0,
        "to": 1714728600
      },
      "nonce": "49580047818451045978333",
      "requested_attributes": {
        "hspeed": {
          "name": "speed",
          "names": null,
          "non_revoked": null,
          "restrictions": null
        }
      },
      "requested_predicates": {},
      "version": "1.0"
    },
    "proof_id": "v2-55b1e815-398c-42e3-8f25-12cbab8645f3",
    "protocol_version": "v2",
    "role": "prover",
    "state": "request-received",
    "thread_id": "6f31a4b9-f064-444e-95bd-a1310d9b0bf1",
    "updated_at": "2024-05-03T09:39:24.853669Z",
    "verified": null
  }
]
holder gets
curl -X 'GET' \
  'http://localhost:8300/v1/verifier/proofs/v2-55b1e815-398c-42e3-8f25-12cbab8645f3/credentials' \
  -H 'accept: application/json'
[
  {
    "cred_info": {
      "attrs": {
        "speed": "100"
      },
      "cred_def_id": "2HpYVPLeLjSBSPuFeV2jDY:3:CL:8:Epic",
      "cred_rev_id": "2",
      "referent": "5fbdf982-587b-41e2-9f92-1864e041deb4",
      "rev_reg_id": "2HpYVPLeLjSBSPuFeV2jDY:4:2HpYVPLeLjSBSPuFeV2jDY:3:CL:8:Epic:CL_ACCUM:70390905-6631-4b6e-8420-d8d1546660aa",
      "schema_id": "xTUR8cJYXPSMKb1CuFSqZ:2:Epic_speed:1.0"
    },
    "interval": {
      "from": 0,
      "to": 1714728600
    },
    "presentation_referents": [
      "hspeed"
    ]
  }
]

holder responds
curl -X 'POST' \
  'http://localhost:8300/v1/verifier/send-request' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "protocol_version": "v2",
  "comment": "Demo",
  "type": "indy",
  "indy_proof_request": {
       "non_revoked": {"from":0 , "to": 1714728600},
       "requested_attributes": {
           "hspeed": { "name": "speed"}
        },
       "requested_predicates": {}
  },
  "save_exchange_record": true,
  "connection_id": "caf1a199-e45d-4daf-ab21-17f181b1b85e"
}'

verifier checks

{
    "wallet_id": "c0330bf8-e755-4deb-b577-03abace9c757",
    "topic": "proofs",
    "origin": "tenant faber",
    "group_id": "GroupA",
    "payload": {
      "connection_id": "caf1a199-e45d-4daf-ab21-17f181b1b85e",
      "created_at": "2024-05-03T09:39:24.748371Z",
      "error_msg": null,
      "parent_thread_id": null,
      "presentation": null,
      "presentation_request": null,
      "proof_id": "v2-20c4f54b-9abe-4cd2-b370-cb5b525f811b",
      "protocol_version": "v2",
      "role": "verifier",
      "state": "done",
      "thread_id": "6f31a4b9-f064-444e-95bd-a1310d9b0bf1",
      "updated_at": "2024-05-03T09:40:40.666820Z",
      "verified": false
    }
  }
```




proof request
    - with non-revoke 
    - explain how and why it works
{
  "protocol_version": "v2",
  "comment": "Demo",
  "type": "indy",
  "indy_proof_request": {
       "name": "Demo",
       "non_revoked": {"from":0 , "to": 1709115193},
       "requested_attributes": {
           "hspeed": { "name": "speed", "restrictions":[{"cred_def_id":"UGmZDLmDjr4ySVUpFKo527:3:CL:8:Epic"}]}
        },
       "requested_predicates": {},
       "version": "1.0"
  },
  "save_exchange_record": true,
  "connection_id": "27231dc3-79fb-4ae5-8dc3-399d349d19f3"
}



{
  "proof_id": "v2-3ed51b75-c401-4628-a126-beb2af62c3fe",
  "type": "indy",
  "indy_presentation_spec": {
    "requested_attributes": {
      "hspeed": {
        "cred_id": "62321bed-06c9-4760-a5ec-77ff50624d99",
        "revealed": true
      }
    },
    "requested_predicates": {},
    "self_attested_attributes": {}
  },
  "dif_presentation_spec": {}
}
