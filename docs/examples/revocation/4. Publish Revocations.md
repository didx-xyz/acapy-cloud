# Publish/Clearing revocations
Revocations that were called with ```"auto_publish_on_ledger": false"``` are pending publication. An issuer can either publish these revocations of clear the revocation i.e. not revoke the credential. 
## Publishing revocation
The publish revocation endpoint can be used to publish revocations in mass or an issuer can be very specific in which revocations they want to publish.

The body sent to the endpoint specifies what needs to be published. This body is a revocation registry to credential map/dictionary. 

Each key is a revocation registry ID (```rev_reg_id```) and its value is a list of credential revocation IDs (```cred_rev_id```) to be published.
The payload below will publish 6 revocations across two registries. 
```http
POST /v1/issuer/credentials/publish-revocations
```
```json
{
  "revocation_registry_credential_map": {
    "WWzcvsHULP1Fkf9GUYRZg8:4:WWzcvsHULP1Fkf9GUYRZg8:3:CL:8:Epic:CL_ACCUM:cd2e0473-31f7-4cde-883d-6fceac1ce0d7":["1","2","3"],
    "WWzcvsHULP1Fkf9GUYRZg8:4:WWzcvsHULP1Fkf9GUYRZg8:3:CL:8:Epic:CL_ACCUM:bf1219ca-75bf-4931-911b-1fe2ace39683":["1","2","4"]
   }
}
```
##

Providing an empty list for a registry ID instructs the system to publish all pending revocations for that ID. The payload below will publish all pending revocations for the given registry id (```rev_reg_id```) 
 
```http
POST /v1/issuer/credentials/publish-revocations
```
```json
{
  "revocation_registry_credential_map": {"WWzcvsHULP1Fkf9GUYRZg8:4:WWzcvsHULP1Fkf9GUYRZg8:3:CL:8:Epic:CL_ACCUM:cd2e0473-31f7-4cde-883d-6fceac1ce0d7":[]}
}
```
##
 
An empty map/dictionary signifies that all pending revocations across all registry IDs (belonging to the issuer) should be published. 

```http
POST /v1/issuer/credentials/publish-revocations
```
```json
{
  "revocation_registry_credential_map": {}
}
```

##
These endpoints responds with a ```204``` status code

The ```issuer_cred_rev``` event will also fire, for every credential that was revoked, after the revocations were published.


## Clearing revocations

The clear revocation endpoint functions in the same way as the publish revocation endpoint. Instead of publishing the revocation it's cleared i.e. the credential is not revoked and still considered valid.

The response to the clearing endpoint is also different from the publish endpoint. The clear pending revocation endpoint responds with the *still* pending revocations.


The payload below will clear the pending revocation on ```cred_rev_id = 5```.
```http
POST /v1/issuer/credentials/clear-pending-revocations'
```
```json
{
  "revocation_registry_credential_map": {
     "CJnbcDL4vBkRzDSw5dS1Pa:4:CJnbcDL4vBkRzDSw5dS1Pa:3:CL:8:Epic:CL_ACCUM:55bd2b4c-672b-4749-b8d3-b1b8137d1012":["5"]
 }
}
```

Response of still pending ```cred_rev_ids``` for the registry:
```json
{
  "revocation_registry_credential_map": {
    "CJnbcDL4vBkRzDSw5dS1Pa:4:CJnbcDL4vBkRzDSw5dS1Pa:3:CL:8:Epic:CL_ACCUM:55bd2b4c-672b-4749-b8d3-b1b8137d1012": [
      "1",
      "2",
      "3",
      "4"
    ]
  }
}
```
##
This call will clear all pending revocations for the given registry id.
```http
POST /v1/issuer/credentials/clear-pending-revocations'
```
```json
{
  "revocation_registry_credential_map": {
     "CJnbcDL4vBkRzDSw5dS1Pa:4:CJnbcDL4vBkRzDSw5dS1Pa:3:CL:8:Epic:CL_ACCUM:55bd2b4c-672b-4749-b8d3-b1b8137d1012":[]
 }
}
```
Response (no more pending revocations):
```json
{
  "revocation_registry_credential_map": {}
}
```
##
This call will clear all revocations for all registries
```http
POST /v1/issuer/credentials/clear-pending-revocations'
```
```json
{
  "revocation_registry_credential_map": {}
}
```
Response (no more pending revocations):
```json
{
  "revocation_registry_credential_map": {}
}
```
##

Now to [verify revoked credentials](../7.%20Verify%20Credential.md#Verifying-revoked-credentials)
